(function(t){function e(e){for(var a,i,s=e[0],c=e[1],u=e[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},o={app:0},r=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"52e4":function(t,e,n){"use strict";var a=n("9c49"),o=n.n(a);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],i=n("2877"),s={},c=Object(i["a"])(s,o,r,!1,null,null,null),u=c.exports,l=n("8c4f"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"draw-container"},[n("custom-crop",{attrs:{imgUrl:t.url,proportion:t.proportion,headerState:!0,newUrl:t.newUrl,width:t.width},on:{"update:newUrl":function(e){t.newUrl=e},"update:new-url":function(e){t.newUrl=e},"out-picture":t.out,reset:t.reset}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.splitState,expression:"splitState"}],staticClass:"preview-container"},[t.newUrl?n("img",{attrs:{src:t.newUrl,alt:"resultImg"}}):t._e()])])},f=[],p={name:"Demo",components:{},data:function(){return{url:"/logo.png",proportion:1,width:"1200px",imgUrl:"",state:!1,newUrl:{type:String,default:null},splitState:!1,canvasState:!0}},mounted:function(){this.open()},methods:{open:function(){this.state=!0},out:function(){this.splitState=!0},reset:function(){this.splitState=!1}}},v=p,h=(n("52e4"),Object(i["a"])(v,d,f,!1,null,"568b4508",null)),m=h.exports;a["a"].use(l["a"]);var g=[{path:"/",name:"demo",component:m}],w=new l["a"]({routes:g}),b=w,y=n("2f62");a["a"].use(y["a"]);var C=new y["a"].Store({state:{},mutations:{},actions:{},modules:{}}),x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.canvasState,expression:"canvasState"}],staticClass:"custom-container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.headerState,expression:"headerState"}],staticClass:"custom-draw-header"},[n("div",{staticClass:"custom-draw-buttons"},[n("button",{attrs:{disabled:!t.status},on:{click:t.complete}},[t._v("完成")]),n("button",{attrs:{disabled:!t.status},on:{click:t.cancel}},[t._v("撤销")]),n("button",{attrs:{disabled:t.status},on:{click:t.outPic}},[t._v("出图")]),n("button",{on:{click:t.reset}},[t._v("重置")])]),t._m(0)]),n("div",{staticClass:"custom-draw-content",style:{width:t.width}},[n("div",{ref:"canvasDiv",staticClass:"custom-canvas"},[n("canvas",{ref:"customCanvas",staticStyle:{width:"100%"},attrs:{id:"custom"},on:{click:t.savePoints,mousemove:t.saveMouse,dblclick:function(e){return e.preventDefault(),t.complete(e)}}}),n("canvas",{ref:"bufferCanvas",staticStyle:{width:"100%",opacity:"0",position:"absolute"},attrs:{id:"buffer"}}),n("canvas",{ref:"clipCanvas",staticStyle:{width:"100%",opacity:"0",position:"absolute"},attrs:{id:"clip"}})])])])},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"custom-draw-info"},[n("span",[t._v("操作说明:1.单击开始绘制边框2.在最后一点处双击完成3.点击出图,查看或保存图片")])])}],S=(n("a9e3"),n("3835")),P=(n("99af"),n("ac1f"),n("466d"),n("5319"),function(){var t=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return{canvas:!!e,imageData:!!e.getImageData,dataURL:!!t.toDataURL,btoa:!!window.btoa}}(),e="image/octet-stream";function n(t,e,n){var a=t.width,o=t.height;void 0==e&&(e=a),void 0==n&&(n=o);var r=document.createElement("canvas"),i=r.getContext("2d");return r.width=e,r.height=n,i.drawImage(t,0,0,a,o,0,0,e,n),r}function a(t,e,a,o){return t=n(t,a,o),t.toDataURL(e)}function o(t){document.location.href=t}function r(t){var e=document.createElement("img");return e.src=t,e}function i(t){t=t.toLowerCase().replace(/jpg/i,"jpeg");var e=t.match(/png|jpeg|bmp|gif/)[0];return"image/"+e}function s(t){if(!window.btoa)throw"btoa undefined";var e="";if("string"==typeof t)e=t;else for(var n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function c(t){var e=t.width,n=t.height;return t.getContext("2d").getImageData(0,0,e,n)}function u(t,e){return"data:"+e+";base64,"+t}var l=function(t){var e=t.width,n=t.height,a=e*n*3,o=a+54,r=[66,77,255&o,o>>8&255,o>>16&255,o>>24&255,0,0,0,0,54,0,0,0],i=[40,0,0,0,255&e,e>>8&255,e>>16&255,e>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,1,0,24,0,0,0,0,0,255&a,a>>8&255,a>>16&255,a>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=(4-3*e%4)%4,u=t.data,l="",d=e<<2,f=n,p=String.fromCharCode;do{for(var v=d*(f-1),h="",m=0;m<e;m++){var g=m<<2;h+=p(u[v+g+2])+p(u[v+g+1])+p(u[v+g])}for(var w=0;w<c;w++)h+=String.fromCharCode(0);l+=h}while(--f);var b=s(r.concat(i))+s(l);return b},d=function(r,s,d,f){if(t.canvas&&t.dataURL)if("string"==typeof r&&(r=document.getElementById(r)),void 0==f&&(f="png"),f=i(f),/bmp/.test(f)){var p=c(n(r,s,d)),v=l(p);o(u(v,e))}else v=a(r,f,s,d),o(v.replace(f,e))},f=function(e,o,s,d){if(t.canvas&&t.dataURL){if("string"==typeof e&&(e=document.getElementById(e)),void 0==d&&(d="png"),d=i(d),/bmp/.test(d)){var f=c(n(e,o,s)),p=l(f);return r(u(p,"image/bmp"))}return p=a(e,d,o,s),r(p)}};return{saveAsImage:d,saveAsPNG:function(t,e,n){return d(t,e,n,"png")},saveAsJPEG:function(t,e,n){return d(t,e,n,"jpeg")},saveAsGIF:function(t,e,n){return d(t,e,n,"gif")},saveAsBMP:function(t,e,n){return d(t,e,n,"bmp")},convertToImage:f,convertToPNG:function(t,e,n){return f(t,e,n,"png")},convertToJPEG:function(t,e,n){return f(t,e,n,"jpeg")},convertToGIF:function(t,e,n){return f(t,e,n,"gif")},convertToBMP:function(t,e,n){return f(t,e,n,"bmp")}}}()),_={props:{imgUrl:{type:String,default:""},proportion:{type:Number,default:1},headerState:{type:Boolean,default:!0},width:{type:String,default:"1980px"},canvasState:{type:Boolean,default:!0}},components:{},name:"customCrop",data:function(){return{points:[],newImg:"",mouse:{x:null,y:null},id:null,status:!0}},mounted:function(){this.loadCanvas()},methods:{savePoints:function(t){this.points.push({x:t.layerX,y:t.layerY})},saveMouse:function(t){this.mouse={x:t.layerX,y:t.layerY}},setCanvas:function(t){var e=document.getElementById(t),n=e.getContext("2d"),a=e.offsetWidth,o=a/this.proportion;return e.width=a,e.height=o,[n,a,o,e]},clearWatchDog:function(){clearInterval(this.id),this.id=null,this.points=null},loadCanvas:function(){var t=this;this.id=setInterval((function(){t.$refs.customCanvas?t.updateCanvas():t.clearWatchDog()}),17)},updateCanvas:function(){var t=this,e=this.setCanvas("buffer"),n=Object(S["a"])(e,4),a=n[0],o=n[1],r=n[2],i=n[3],s=new Image;s.src=this.imgUrl,a.clearRect(0,0,o,r),s.onload=function(){a.drawImage(s,0,0,o,r),t.drawLine(a),t.copyCanvas(i)}},drawLine:function(t){var e=this.points;t.lineWidth=2,t.lineJoin="round";for(var n=0;n<e.length;n++)t.lineTo(e[n].x,e[n].y),t.moveTo(e[n].x+4,e[n].y),t.arc(e[n].x,e[n].y,4,0,2*Math.PI),t.moveTo(e[n].x,e[n].y);t.lineTo(this.mouse.x,this.mouse.y),t.moveTo(this.mouse.x+4,this.mouse.y),t.arc(this.mouse.x,this.mouse.y,4,0,2*Math.PI),t.moveTo(this.mouse.x,this.mouse.y),t.stroke()},copyCanvas:function(t){var e=this.setCanvas("custom"),n=Object(S["a"])(e,1),a=n[0];a.drawImage(t,0,0)},complete:function(){var t=this.setCanvas("clip"),e=Object(S["a"])(t,3),n=e[0],a=e[1],o=e[2];this.canvasClip(n),this.updateImg(n,a,o),this.status=!1,this.clearWatchDog()},canvasClip:function(t){t.beginPath();for(var e=0;e<this.points.length;e++){var n=this.points[e];t.lineTo(n.x,n.y)}t.clip(),t.closePath()},updateImg:function(t,e,n){var a=new Image;a.src=this.imgUrl,a.onload=function(){t.drawImage(a,0,0,e,n)}},cancel:function(){this.points.pop(),null===this.id&&this.loadCanvas()},outPic:function(){var t=document.getElementById("clip");this.canvasToImg(t),this.$emit("update:newUrl",this.newImg),this.$emit("out-picture"),this.clearWatchDog()},canvasToImg:function(t){var e=t.offsetWidth,n=e/this.proportion,a=P.convertToImage(t,e,n,"png");this.newImg=a.src},close:function(){this.$emit("close-custom"),this.clearWatchDog()},reset:function(){this.$emit("reset"),this.status?this.points=[]:(this.points=[],this.loadCanvas(),this.status=!0)}}},j=_,U=(n("8d65"),Object(i["a"])(j,x,I,!1,null,"2e1a7b12",null)),T=U.exports,O={install:function(t,e){t.component("customCrop",T)}},D=O;a["a"].use(D),a["a"].config.productionTip=!1,new a["a"]({router:b,store:C,render:function(t){return t(u)}}).$mount("#app")},"8d65":function(t,e,n){"use strict";var a=n("eed9"),o=n.n(a);o.a},"9c49":function(t,e,n){},eed9:function(t,e,n){}});
//# sourceMappingURL=app.91bbd2e9.js.map